I"	ˇ<h1 class="no_toc" id="analysis-on-pbmc12k-scrna-seq-data-via-scminer">Analysis on PBMC(12k) scRNA-seq data via scMINER</h1>

<h2 class="no_toc text-delta" id="table-of-contents">Table of contents</h2>

<ol id="markdown-toc">
  <li><a href="#demo-data" id="markdown-toc-demo-data">Demo data</a></li>
  <li><a href="#step-1-data-preprocessing" id="markdown-toc-step-1-data-preprocessing">Step 1: Data preprocessing</a>    <ol>
      <li><a href="#read-10x-genomics-data" id="markdown-toc-read-10x-genomics-data">Read 10x genomics data</a></li>
      <li><a href="#quality-control-and-data-filtering" id="markdown-toc-quality-control-and-data-filtering">Quality control and data filtering</a></li>
      <li><a href="#normalization-and-transformation" id="markdown-toc-normalization-and-transformation">Normalization and transformation</a></li>
    </ol>
  </li>
  <li><a href="#step-2-perform-clustering-analysis-via-mica" id="markdown-toc-step-2-perform-clustering-analysis-via-mica">Step 2: Perform clustering analysis via MICA</a>    <ol>
      <li><a href="#generate-mica-input-and-command" id="markdown-toc-generate-mica-input-and-command">Generate MICA input and command</a></li>
    </ol>
  </li>
  <li><a href="#step-3-cell-type-annotation-after-clustering" id="markdown-toc-step-3-cell-type-annotation-after-clustering">Step 3: Cell type annotation after clustering</a>    <ol>
      <li><a href="#read-mica-output" id="markdown-toc-read-mica-output">Read MICA output</a></li>
      <li><a href="#marker-gene-visualization" id="markdown-toc-marker-gene-visualization">Marker gene visualization</a></li>
      <li><a href="#assign-cell-type-to-cluster" id="markdown-toc-assign-cell-type-to-cluster">Assign cell type to cluster</a></li>
    </ol>
  </li>
  <li><a href="#step-4-network-generation-via-sjaracne" id="markdown-toc-step-4-network-generation-via-sjaracne">Step 4: Network generation via SJARACNe</a>    <ol>
      <li><a href="#generate-sjaracne-input" id="markdown-toc-generate-sjaracne-input">Generate SJARACNe input</a></li>
      <li><a href="#run-sjaracne" id="markdown-toc-run-sjaracne">Run SJARACNe</a></li>
    </ol>
  </li>
  <li><a href="#step-5-identify-cell-type-specific-hidden-driver" id="markdown-toc-step-5-identify-cell-type-specific-hidden-driver">Step 5: Identify cell type specific hidden driver</a>    <ol>
      <li><a href="#calculate-activity" id="markdown-toc-calculate-activity">Calculate activity</a></li>
      <li><a href="#driver-estimation-by-differential-activity-analysis" id="markdown-toc-driver-estimation-by-differential-activity-analysis">Driver estimation by differential activity analysis</a></li>
    </ol>
  </li>
  <li><a href="#r-session-info" id="markdown-toc-r-session-info">R session Info</a></li>
</ol>

<hr />

<h2 class="d-inline-block" id="demo-data">Demo data</h2>

<p>Here we demonstrate our pipeline using PBMC (10x genmomics) scRNA-seq data. Full data contains 68k cells, in order to provide a faster guidance, we‚Äôve down sampled this data to 12k cells. Original data can be downloaded <a href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/fresh_68k_pbmc_donor_a">here</a>.</p>

<h2 class="d-inline-block" id="step-1-data-preprocessing">Step 1: Data preprocessing</h2>

<h3 id="read-10x-genomics-data">Read 10x genomics data</h3>
<p>Read 10x genomics data with function <code class="highlighter-rouge">readscRNAseqData </code>in scMINER package. This function could help read data from either 10x genomics standard output(usually contains three individual files: matrix.mtx, barcodes.tsv, features.tsv), or other text files by passing arguments to <code class="highlighter-rouge">read.delim()</code>.</p>

<p>This function helps create a Sparse matrix object using Expressionset prototype, If set <code class="highlighter-rouge">CreateSparseEset=T</code>. Otherwise, it will create a list object that stores expression data, feature data and sample data under three separate slots. If <code class="highlighter-rouge">add.meta=T</code>, then additional sample info such as total number of UMI will be calcualated and outputed in sample data. Here, we defined <code class="highlighter-rouge">is.10x=T</code>,<code class="highlighter-rouge">CreateSparseEset = F</code>, and <code class="highlighter-rouge">add.meta=F</code>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">d.12k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readscRNAseqData</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"../PBMC12k_input/"</span><span class="p">,</span><span class="n">is.10x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="n">CreateSparseEset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">add.meta</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>After loading data to environment properly, you can now create Sparse Matrix expression by using <code class="highlighter-rouge">CreateSparseEset</code>function:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eset.12k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CreateSparseEset</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d.12k</span><span class="p">,</span><span class="w"> </span><span class="n">add.meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="quality-control-and-data-filtering">Quality control and data filtering</h3>
<p>Quality control assessments could be done using <code class="highlighter-rouge">draw.scRNAseq.QC</code> function, which outputs a html report generated through Rmarkdown(<a href="./PBMC12k_scRNAseq_QC.html">PBMC12K_QC_report.html</a>). The report includes three essential quality control figures at both gene and cell level. Suggested cutoff will be returned as a list if set <code class="highlighter-rouge">output.cutoff=TRUE</code>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutoffs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">draw.scRNAseq.QC</span><span class="p">(</span><span class="n">SparseEset</span><span class="o">=</span><span class="n">eset.12k</span><span class="p">,</span><span class="w"> 
                          </span><span class="n">project.name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PBMC12k"</span><span class="p">,</span><span class="w">
                          </span><span class="n">plot.dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"./QC/"</span><span class="p">,</span><span class="w">
                          </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"group"</span><span class="p">,</span><span class="w"> </span><span class="c1"># this indicate which meta data information will be use in x axis to group violin plots</span><span class="w">
                          </span><span class="n">output.cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>The first plot is a histogram which helps visualize distribution of expressed genes among each cells. Blue veritcal line shows the recommended cutoff. Genes expressed lower number of cells than threshold should be filtered.</p>

<center><img src="./plots/1_1_Gene_QCmetrics_before_filtering.png" alt="drawing" width="700" /></center>

<p>The second plot helps visualize total UMI count, and total number of gene expressed in violin plots. Horizontal blue line indicates suggested high/low cutoffs. Suggested thresholds were computed based on Median ¬± 3 * MAD (Maximum absolute deviance). Actual threshold numbers are also printed right above blue lines in green labels.
<img src="./plots/1_2_Cell_QC_1.png" alt="" /></p>

<p>The third plot visualizes mitochondrial gene expression percentage, and spike-in genes expression percentage for each cell V.S. total number of UMI in scatter plots. Cells with high percentage of mitochondrial gene expression but low total number of UMI count are often considered as low quality.
<img src="./plots/1_3_Cell_QC_2.png" alt="" /></p>

<p>Then you could perform filtering with function <code class="highlighter-rouge">preMICA.filtering</code>. We recommend to input <code class="highlighter-rouge">cutoffs</code> using thresholds list which directly outputted from <code class="highlighter-rouge">draw.scRNAseq.QC</code> functon. You could also manually change cutoffs by re-assign thresholds in <code class="highlighter-rouge">cutoffs</code> list, e.g. <code class="highlighter-rouge">cutoffs$umi_cf_hi &lt;- Inf</code> means not doing filtering on outliers caused by high total UMI value.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutoffs</span><span class="o">$</span><span class="n">umi_cf_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">Inf</span><span class="w">  </span><span class="c1"># only filter on low total number of UMI</span><span class="w">
</span><span class="n">eset.sel</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">preMICA.filtering</span><span class="p">(</span><span class="n">SparseEset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eset.12k</span><span class="p">,</span><span class="w"> </span><span class="n">cutoffs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutoffs</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="normalization-and-transformation">Normalization and transformation</h3>
<p>In scMINER package, we don‚Äôt provide methods to perform data normalizaton. You can use your own prefered normalization method. However, <strong>we highly recommend to do CPM and log2 transformation for MICA input</strong>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1e6</span><span class="w"> 
</span><span class="n">exp.norm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sweep</span><span class="p">(</span><span class="n">exprs</span><span class="p">(</span><span class="n">eset.sel</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">norm</span><span class="o">/</span><span class="n">unname</span><span class="p">(</span><span class="n">Matrix</span><span class="o">::</span><span class="n">colSums</span><span class="p">(</span><span class="n">exprs</span><span class="p">(</span><span class="n">eset.sel</span><span class="p">))),</span><span class="w"> </span><span class="s1">'*'</span><span class="p">)</span><span class="w">

</span><span class="c1"># log transformation</span><span class="w">
</span><span class="c1"># Required for MICA</span><span class="w">
</span><span class="n">exp.log2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">exp.norm</span><span class="m">+1</span><span class="p">,</span><span class="n">base</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">

</span><span class="c1"># save as SparseEset</span><span class="w">
</span><span class="n">eset.log2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CreateSparseEset</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">exp.log2</span><span class="p">,</span><span class="w"> </span><span class="n">meta.data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pData</span><span class="p">(</span><span class="n">eset.sel</span><span class="p">),</span><span class="w"> </span><span class="n">feature.data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fData</span><span class="p">(</span><span class="n">eset.sel</span><span class="p">),</span><span class="w"> </span><span class="n">add.meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 class="d-inline-block" id="step-2-perform-clustering-analysis-via-mica">Step 2: Perform clustering analysis via MICA</h2>

<p>MICA was implemented in Python. If you would like to install MICA, please refer to <a href="https://github.com/jyyulab/MICA">MICA github page</a>. There are several handlers for you to choose in MICA for better visualization. A more comprehensive tutorial could be found under <a href="./MICA.md">Clustering with MICA</a> tab . <strong>Here we suggest saving your working directory prior to running MICA</strong>.</p>

<h3 id="generate-mica-input-and-command">Generate MICA input and command</h3>
<p>After reviewing all visualizations and finished filtering, you can go ahead and generate clustering (MICA) input with function <code class="highlighter-rouge">generateMICAinput</code>. This function takes an expression matrix as input, and outputs a cell by gene .txt file. Please note that <strong>you should always feed MICA the log or log2 transformed data</strong>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">generateMICAinput</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">exp.log2</span><span class="w"> </span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s2">"PBMC12k_MICA_input.txt"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>We also offer a function called <code class="highlighter-rouge">generate_MICA_cmd </code> to help write MICA command in a shell script. In order to run MICA on LSF, you need to set <code class="highlighter-rouge">host=lsf</code>,  define <code class="highlighter-rouge">queue = [your queue]</code> (required), and <code class="highlighter-rouge">memory</code> (optional). In <code class="highlighter-rouge">num_cluster</code>, you can specify a vector of number of K to perform clustering analysis for different number of cluster simultaneously.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">generate_MICA_cmd</span><span class="p">(</span><span class="n">save_sh_at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"./PBMC12k/"</span><span class="p">,</span><span class="w">
                  </span><span class="n">input_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"./PBMC12k/PBMC12k_MICA_input.txt"</span><span class="p">,</span><span class="w">
                  </span><span class="n">project_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PBMC12k"</span><span class="p">,</span><span class="w">
                  </span><span class="n">num_cluster</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">13</span><span class="p">,</span><span class="m">14</span><span class="p">,</span><span class="m">15</span><span class="p">),</span><span class="w">
                  </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lsf"</span><span class="p">,</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">your_queue</span><span class="p">],</span><span class="w">
                  </span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">8000</span><span class="p">,</span><span class="w"> </span><span class="m">12000</span><span class="p">,</span><span class="w"> </span><span class="m">16000</span><span class="p">,</span><span class="w"> </span><span class="m">16000</span><span class="p">),</span><span class="w">
                  </span><span class="n">output_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"./"</span><span class="p">,</span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"standard"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 class="d-inline-block" id="step-3-cell-type-annotation-after-clustering">Step 3: Cell type annotation after clustering</h2>

<h3 id="read-mica-output">Read MICA output</h3>

<p>After clustering via MICA, with function <code class="highlighter-rouge">readMICAoutput</code>, you can load MICA output (in .txt) as well as your input expression matrix in R to an <code class="highlighter-rouge">expressionSet</code> object. <code class="highlighter-rouge">ExpressionSet</code> is the major data structure we used for downstream analysis in R.</p>

<blockquote>
  <p><strong>Note: All functions are designed compatible for both expressionSet and SparseExpressionSet</strong></p>
</blockquote>

<p>Users shall start with one particular MICA membership and study your optimal number of cluster with cell type signatures. By setting <code class="highlighter-rouge">load_ClusterRes</code> as TRUE, clustering label will be saved under <code class="highlighter-rouge">eset$ClusterRes</code>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readMICAoutput</span><span class="p">(</span><span class="n">eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eset.norm</span><span class="p">,</span><span class="w"> </span><span class="n">load_ClusterRes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">output_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MICA/PBMC12k_k8_tsne_ClusterMem.txt"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>In order to visualize MICA labels or other metadata on tSNE/UMAP coordinates, your can use function <code class="highlighter-rouge">MICAplot</code>. Users are required to specify <code class="highlighter-rouge">X</code> and <code class="highlighter-rouge">Y</code> coordinates in this function. Other meta data could also be visualized by changing <code class="highlighter-rouge">label</code> handler. This function outputs a ggplot object.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MICAplot</span><span class="p">(</span><span class="n">input_eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eset</span><span class="p">,</span><span class="n">visualize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'tSNE'</span><span class="p">,</span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="s2">"Y"</span><span class="p">,</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"label"</span><span class="p">,</span><span class="n">pct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<center><img src="./plots/3_0_MICA_k8.png" alt="MICA" width="600" /></center>

<h3 id="marker-gene-visualization">Marker gene visualization</h3>

<p>Picked marker genes could be visualized on t-SNE scatterplot, violin plot or heatmap via function <code class="highlighter-rouge">feature_highlighting</code>, <code class="highlighter-rouge">feature_vlnplot</code> and <code class="highlighter-rouge">feature_heatmap</code>. This will not only help cluster annotation, but also identify optimal number of clusters as well.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gn.sel</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s2">"CD3D"</span><span class="p">,</span><span class="s2">"CD27"</span><span class="p">,</span><span class="s2">"IL7R"</span><span class="p">,</span><span class="s2">"SELL"</span><span class="p">,</span><span class="s2">"CCR7"</span><span class="p">,</span><span class="s2">"IL32"</span><span class="p">,</span><span class="s2">"GZMA"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"GZMK"</span><span class="p">,</span><span class="s2">"DUSP2"</span><span class="p">,</span><span class="s2">"CD8A"</span><span class="p">,</span><span class="s2">"GZMH"</span><span class="p">,</span><span class="s2">"GZMB"</span><span class="p">,</span><span class="s2">"CD79A"</span><span class="p">,</span><span class="s2">"CD79B"</span><span class="p">,</span><span class="s2">"CD86"</span><span class="p">,</span><span class="s2">"CD14"</span><span class="p">)</span><span class="w">

</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">feature_highlighting</span><span class="p">(</span><span class="n">input_eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eset</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gn.sel</span><span class="p">,</span><span class="w"> 
	</span><span class="n">feature</span><span class="o">=</span><span class="s2">"geneSymbol"</span><span class="p">,</span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log2Exp"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s2">"X"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s2">"Y"</span><span class="p">,</span><span class="n">pct.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<center><img src="./plots/3_1_gene_highlighting.png" alt="Scatterplot" width="800" /></center>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">feature_vlnplot</span><span class="p">(</span><span class="n">input_eset</span><span class="o">=</span><span class="n">eset</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="n">gn.sel</span><span class="p">,</span><span class="n">feature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"geneSymbol"</span><span class="p">,</span><span class="w">
	</span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ClusterRes"</span><span class="p">,</span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log2Exp"</span><span class="p">,</span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<center><img src="./plots/3_2_gene_highlighting_vlnplot.png" alt="violinplot" width="800" /></center>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">feature_heatmap</span><span class="p">(</span><span class="n">eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eset</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gn.sel</span><span class="p">,</span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ClusterRes"</span><span class="p">,</span><span class="w">
			 	</span><span class="n">save_plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w">
             </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log2_expression"</span><span class="p">,</span><span class="n">plot_name</span><span class="o">=</span><span class="s2">"./GeneHeatmap.png"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<center><img src="./plots/3_3_Marker_heatmaps.png" alt="heatmaps" width="800" /></center>

<h3 id="assign-cell-type-to-cluster">Assign cell type to cluster</h3>

<p>In order to help assign cell types to each cluster in a more systemmatic way, we introduced <code class="highlighter-rouge">marker_bbplot</code> function. This function calculated cell type scores for each clusters, and visualize scores using bubble plot, with color scale indicates marker score while circle(bubble) stand for sizes. However, this fucntion requires a pre-defined marker gene lists as input, here we curated a list of well-known marker genes of 9 common immune celltypes as <code class="highlighter-rouge">ref</code>. <strong>Users are required to follow below header format in order to run this function properly</strong>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ref</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.xlsx</span><span class="p">(</span><span class="s2">"Immune_signatures.xlsx"</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="w">
  </span><span class="n">celltype</span><span class="w"> </span><span class="n">markers</span><span class="w"> </span><span class="n">weight</span><span class="w">
</span><span class="m">1</span><span class="w">   </span><span class="n">NaiveT</span><span class="w">    </span><span class="n">SELL</span><span class="w">      </span><span class="m">1</span><span class="w">
</span><span class="m">2</span><span class="w">   </span><span class="n">NaiveT</span><span class="w">    </span><span class="n">CCR7</span><span class="w">      </span><span class="m">1</span><span class="w">
</span><span class="m">3</span><span class="w">     </span><span class="n">Tmem</span><span class="w">    </span><span class="n">IL7R</span><span class="w">      </span><span class="m">1</span><span class="w">
</span><span class="m">4</span><span class="w">     </span><span class="n">Tmem</span><span class="w">    </span><span class="n">CD27</span><span class="w">      </span><span class="m">1</span><span class="w">
</span><span class="m">5</span><span class="w">     </span><span class="n">Tmem</span><span class="w">    </span><span class="n">IL32</span><span class="w">      </span><span class="m">1</span><span class="w">
</span><span class="m">6</span><span class="w">     </span><span class="n">Tmem</span><span class="w">    </span><span class="n">GZMA</span><span class="w">     </span><span class="m">-1</span><span class="w">

</span><span class="n">marker_bbplot</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span><span class="n">eset</span><span class="o">=</span><span class="n">eset</span><span class="p">,</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"geneSymbol"</span><span class="p">,</span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ClusterRes"</span><span class="p">,</span><span class="w">
                   </span><span class="n">save_plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">plot_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"plots/MICA_cluster_score.png"</span><span class="p">)</span><span class="w">

</span></code></pre></div></div>
<center><img src="./plots/3_4_MICA_cluster_score.png" alt="Markerbbp" width="800" /></center>

<p>Before diving into network generation section, please assign your celltype as factors in your expression set. <strong>Please do not include ‚Äú_‚Äù in your cell type names since it will cause mis-parsing in later analysis</strong>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">indx</span><span class="o">&lt;-</span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"NaiveT"</span><span class="p">,</span><span class="s2">"Tmem"</span><span class="p">,</span><span class="s2">"CD8em"</span><span class="p">,</span><span class="s2">"CD8eff"</span><span class="p">,</span><span class="s2">"NK"</span><span class="p">,</span><span class="s2">"Bcell"</span><span class="p">,</span><span class="s2">"DC"</span><span class="p">,</span><span class="s2">"Mo"</span><span class="p">),</span><span class="w">
             </span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"NaiveT"</span><span class="p">,</span><span class="s2">"Tmem"</span><span class="p">,</span><span class="s2">"CD8em"</span><span class="p">,</span><span class="s2">"CD8eff"</span><span class="p">,</span><span class="s2">"NK"</span><span class="p">,</span><span class="s2">"Bcell"</span><span class="p">,</span><span class="s2">"DC"</span><span class="p">,</span><span class="s2">"Mo"</span><span class="p">))</span><span class="w">
</span><span class="n">eset</span><span class="o">$</span><span class="n">celltype</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">indx</span><span class="p">[</span><span class="n">eset</span><span class="o">$</span><span class="n">ClusterRes</span><span class="p">]</span><span class="w">

</span></code></pre></div></div>

<h2 id="step-4-network-generation-via-sjaracne">Step 4: Network generation via SJARACNe</h2>

<h3 id="generate-sjaracne-input">Generate SJARACNe input</h3>
<p>Before generating cell type/group/cluster specific network, group information should be stored under <code class="highlighter-rouge">pData([your_expressionSet])</code>. An R function called <code class="highlighter-rouge">generateSJAracneInput</code> will help to partition input expression matrix and perform essential filtering(filter out 0 expressed genes in cluster) to ensure a reliable network construction. <code class="highlighter-rouge">funcType</code> is required to specify what kind of network to generate. If set <code class="highlighter-rouge">funcType="TF"</code>, a reference transcription factor list will be loaded automatically without manual input. However, you do need to define species information for your data using under <code class="highlighter-rouge">ref</code>.</p>

<p>This function will help create one directory for each group/cell type, containing required input for SJARACNe such as filtered expression matrix in .exp format and filtered TF list in .txt format.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">generateSJARACNeInput</span><span class="p">(</span><span class="w">
	</span><span class="n">eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eset.12k</span><span class="p">,</span><span class="n">funcType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TF"</span><span class="p">,</span><span class="w"> 
	</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"hg"</span><span class="p">,</span><span class="w">  </span><span class="c1">#human</span><span class="w">
	</span><span class="n">wd.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"SJARACNE"</span><span class="p">,</span><span class="w">  </span><span class="c1">#Output directory</span><span class="w">
	</span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"celltype"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="run-sjaracne">Run SJARACNe</h3>

<p>SJARACNe works as a separate module which was implemented in python, please refer to <a href="https://github.com/jyyulab/SJARACNe">SJARACNe</a> github page for installation and basic usage. Please save your working directory before running SJARACNe.</p>

<p>Here we provide an example to run SJARACNe for all celltypes/clusters. After SJARACNe was sucessfully completed, you will be able to get one network for each cell and functional type.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>indir = ~/PBMC12K/SJARACNE_PBMC12K/

for i in $(ls -d */ | cut -f1 -d'/');do
sjaracne ${i} $indir/${i}/*.exp $indir/${i}/tf/*.txt $indir/${i}/tf/ --c_threshold 0.01;
echo ${i} has been submitted!;
done
</code></pre></div></div>

<h2 id="step-5-identify-cell-type-specific-hidden-driver">Step 5: Identify cell type specific hidden driver</h2>

<p>Identify hidden driver from content-based network is the key step in scMINER to help understand your scRNA-seq data, and provide biological insight.</p>

<h3 id="calculate-activity">Calculate activity</h3>
<p>Activity calculation is the basis of driver estimation in scMINER. To infer driver activity, expression profile of their targets are intergrated via function <code class="highlighter-rouge">GetActivityFromSJARACNe</code>. This function takes SJARACNe output path and expression set as input, and return an activity set as well as structured network files if set 	<code class="highlighter-rouge">save_network_files=TRUE</code>.</p>

<p>Since scRNA-seq data are extremly sparse and noisy, please set <code class="highlighter-rouge">activity.method</code> as <code class="highlighter-rouge">'unweighted'</code>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">acs.12k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">GetActivityFromSJARACNe</span><span class="p">(</span><span class="w">
    </span><span class="n">SJARACNe_output_path</span><span class="w"> </span><span class="o">=</span><span class="s2">"SJARACNE/"</span><span class="p">,</span><span class="w">
    </span><span class="n">SJARACNe_input_eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eset.12k</span><span class="p">,</span><span class="w">
    </span><span class="n">activity.method</span><span class="o">=</span><span class="s2">"unweighted"</span><span class="p">,</span><span class="w"> </span><span class="c1"># we highly recommend using 'unweighted' as activity calculation method</span><span class="w">
    </span><span class="n">activity.norm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> 
    </span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"celltype"</span><span class="p">,</span><span class="w"> </span><span class="c1"># which group was used to partition expression profiles</span><span class="w">
    </span><span class="n">save_network_file</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="c1"># whether or not save network for each group</span><span class="w">
    </span><span class="n">save_path</span><span class="o">=</span><span class="s2">"./networks/"</span><span class="p">)</span><span class="w"> </span><span class="c1">#default as false, but recommended to be TRUE</span><span class="w">
</span></code></pre></div></div>

<h3 id="driver-estimation-by-differential-activity-analysis">Driver estimation by differential activity analysis</h3>

<p>The function <code class="highlighter-rouge">FindDAG</code> was designed to perform differnetial activity analysis from SJARACNe inferred activity matrix. In this function, two-sided student‚Äôs t-test will be performed to compare mean activity from one cell type V.S. the others. It will return a data frame that includes all TF occurred in original data. Statistics such as t.statistics, p-value, 95%CI, etc. are outputed to help identify hidden drivers. You can save it to file in order to check them manually.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">DAG_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">FindDAG</span><span class="p">(</span><span class="n">eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acs.demo</span><span class="p">,</span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"celltype"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>We also offer a function called <code class="highlighter-rouge">TopDriversfromDAG</code> to help picking top drivers for each cell type. You can specify <code class="highlighter-rouge">n</code> as maximum number of top drivers to pick, and <code class="highlighter-rouge">degree_filter</code> to restrict number of targets.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">TF_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">TopDriversfromDAG</span><span class="p">(</span><span class="n">DAG_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DAG_result</span><span class="p">,</span><span class="w">
                              </span><span class="n">celltype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">acs.12k</span><span class="o">$</span><span class="n">celltype</span><span class="p">),</span><span class="w"> </span><span class="c1"># ensure cluster order</span><span class="w">
                              </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">degree_filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">600</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>In scMINER, we provide a handful of visualizations to compare driver activity from different cell type/clusters. Here we demo two basic functions: <code class="highlighter-rouge">feature_heatmap</code> and <code class="highlighter-rouge">feature_vlnplot</code>. These functions could be used on either expression and activty matrix.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">feature_heatmap</span><span class="p">(</span><span class="n">input_eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acs.12k</span><span class="p">,</span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TF_list</span><span class="p">,</span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"celltype"</span><span class="p">,</span><span class="n">feature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"geneSymbol"</span><span class="p">,</span><span class="w">
             </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">save_plot</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
             </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Activity"</span><span class="p">,</span><span class="n">plot_name</span><span class="o">=</span><span class="s2">"./21_TopTFHeatmap.png"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<center><img src="./plots/4_1_TopTFHeatmap.png" alt="Driver heatmap" width="550" /></center>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#check postive controls</span><span class="w">
</span><span class="n">p</span><span class="o">&lt;-</span><span class="n">feature_vlnplot</span><span class="p">(</span><span class="n">input_eset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acs.12k</span><span class="p">,</span><span class="n">feature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"geneSymbol"</span><span class="p">,</span><span class="n">target</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"LEF1"</span><span class="p">,</span><span class="s2">"TCF7"</span><span class="p">,</span><span class="s2">"BATF"</span><span class="p">,</span><span class="s2">"TBX21"</span><span class="p">,</span><span class="s2">"IRF8"</span><span class="p">,</span><span class="s2">"SPIB"</span><span class="p">,</span><span class="s2">"BATF3"</span><span class="p">,</span><span class="s2">"CEBPA"</span><span class="p">),</span><span class="w">
                    </span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Activity"</span><span class="p">,</span><span class="n">group_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"celltype"</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<center><img src="./plots/4_2_Known_MR_vlnplot.png" alt="Driver heatmap" width="600" /></center>

<p>In order to perform more advanced network analysis utilizing SJARACNe generated cell type specific networks, please infer detailed guidance under <a href="./PBMC-12k-network.md">Advanced analysis</a> tab.</p>

<hr />

<h2 id="r-session-info">R session Info</h2>
<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">sessionInfo</span><span class="p">()</span><span class="w">
</span><span class="n">R</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="m">3.6.1</span><span class="w"> </span><span class="p">(</span><span class="m">2019-07-05</span><span class="p">)</span><span class="w">
</span><span class="n">Platform</span><span class="o">:</span><span class="w"> </span><span class="n">x86_64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">darwin15.6.0</span><span class="w"> </span><span class="p">(</span><span class="m">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="w">
</span><span class="n">Running</span><span class="w"> </span><span class="n">under</span><span class="o">:</span><span class="w"> </span><span class="n">macOS</span><span class="w"> </span><span class="n">Mojave</span><span class="w"> </span><span class="m">10.14.3</span><span class="w">

</span><span class="n">Matrix</span><span class="w"> </span><span class="n">products</span><span class="o">:</span><span class="w"> </span><span class="n">default</span><span class="w">
</span><span class="n">BLAS</span><span class="o">:</span><span class="w">   </span><span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">Accelerate.framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="n">A</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">vecLib.framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="n">A</span><span class="o">/</span><span class="n">libBLAS.dylib</span><span class="w">
</span><span class="n">LAPACK</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">R.framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="m">3.6</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libRlapack.dylib</span><span class="w">

</span><span class="n">locale</span><span class="o">:</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="n">en_US.UTF</span><span class="m">-8</span><span class="o">/</span><span class="n">en_US.UTF</span><span class="m">-8</span><span class="o">/</span><span class="n">en_US.UTF</span><span class="m">-8</span><span class="o">/</span><span class="n">C</span><span class="o">/</span><span class="n">en_US.UTF</span><span class="m">-8</span><span class="o">/</span><span class="n">en_US.UTF</span><span class="m">-8</span><span class="w">

</span><span class="n">attached</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">packages</span><span class="o">:</span><span class="w">
 </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="n">stats4</span><span class="w">    </span><span class="n">grid</span><span class="w">      </span><span class="n">parallel</span><span class="w">  </span><span class="n">stats</span><span class="w">     </span><span class="n">graphics</span><span class="w">  </span><span class="n">grDevices</span><span class="w"> </span><span class="n">utils</span><span class="w">     </span><span class="n">datasets</span><span class="w">  </span><span class="n">methods</span><span class="w">   </span><span class="n">base</span><span class="w">     

</span><span class="n">other</span><span class="w"> </span><span class="n">attached</span><span class="w"> </span><span class="n">packages</span><span class="o">:</span><span class="w">
 </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="n">scMINER_0.1.0</span><span class="w">               </span><span class="n">NetBID2_2.0.1</span><span class="w">               </span><span class="n">openxlsx_4.1.0.1</span><span class="w">            </span><span class="n">msigdbr_7.0.1</span><span class="w">               </span><span class="n">GSVA_1.32.0</span><span class="w">                 </span><span class="n">biomaRt_2.40.4</span><span class="w">             
 </span><span class="p">[</span><span class="m">7</span><span class="p">]</span><span class="w"> </span><span class="n">reshape_0.8.8</span><span class="w">               </span><span class="n">arm_1.10</span><span class="m">-1</span><span class="w">                  </span><span class="n">MASS_7.3</span><span class="m">-51.4</span><span class="w">               </span><span class="n">MCMCglmm_2.29</span><span class="w">               </span><span class="n">ape_5.3</span><span class="w">                     </span><span class="n">coda_0.19</span><span class="m">-3</span><span class="w">                
</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="n">ordinal_2019.4</span><span class="m">-25</span><span class="w">           </span><span class="n">umap_0.2.3.1</span><span class="w">                </span><span class="n">plotrix_3.7</span><span class="m">-6</span><span class="w">               </span><span class="n">plot3D_1.1.1</span><span class="w">                </span><span class="n">igraph_1.2.4.1</span><span class="w">              </span><span class="n">aricode_0.1.2</span><span class="w">              
</span><span class="p">[</span><span class="m">19</span><span class="p">]</span><span class="w"> </span><span class="n">ConsensusClusterPlus_1.48.0</span><span class="w"> </span><span class="n">DESeq2_1.24.0</span><span class="w">               </span><span class="n">tximport_1.12.3</span><span class="w">             </span><span class="n">impute_1.58.0</span><span class="w">               </span><span class="n">limma_3.40.6</span><span class="w">                </span><span class="n">GEOquery_2.52.0</span><span class="w">            
</span><span class="p">[</span><span class="m">25</span><span class="p">]</span><span class="w"> </span><span class="n">lme4_1.1</span><span class="m">-21</span><span class="w">                 </span><span class="n">SummarizedExperiment_1.14.1</span><span class="w"> </span><span class="n">DelayedArray_0.10.0</span><span class="w">         </span><span class="n">BiocParallel_1.18.1</span><span class="w">         </span><span class="n">matrixStats_0.55.0</span><span class="w">          </span><span class="n">GenomicRanges_1.36.1</span><span class="w">       
</span><span class="p">[</span><span class="m">31</span><span class="p">]</span><span class="w"> </span><span class="n">GenomeInfoDb_1.20.0</span><span class="w">         </span><span class="n">IRanges_2.18.3</span><span class="w">              </span><span class="n">S4Vectors_0.22.1</span><span class="w">            </span><span class="n">kableExtra_1.1.0</span><span class="w">            </span><span class="n">knitr_1.25</span><span class="w">                  </span><span class="n">Matrix_1.2</span><span class="m">-17</span><span class="w">              
</span><span class="p">[</span><span class="m">37</span><span class="p">]</span><span class="w"> </span><span class="n">rmarkdown_1.16</span><span class="w">              </span><span class="n">cowplot_1.0.0</span><span class="w">               </span><span class="n">dplyr_0.8.3</span><span class="w">                 </span><span class="n">pheatmap_1.0.12</span><span class="w">             </span><span class="n">ComplexHeatmap_2.0.0</span><span class="w">        </span><span class="n">scales_1.0.0</span><span class="w">               
</span><span class="p">[</span><span class="m">43</span><span class="p">]</span><span class="w"> </span><span class="n">RColorBrewer_1.1</span><span class="m">-2</span><span class="w">          </span><span class="n">ggplot2_3.2.1</span><span class="w">               </span><span class="n">reshape2_1.4.3</span><span class="w">              </span><span class="n">Biobase_2.44.0</span><span class="w">              </span><span class="n">BiocGenerics_0.30.0</span><span class="w">         </span><span class="n">BiocManager_1.30.4</span><span class="w">         

</span><span class="n">loaded</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="p">(</span><span class="n">and</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">attached</span><span class="p">)</span><span class="o">:</span><span class="w">
  </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="n">backports_1.1.4</span><span class="w">        </span><span class="n">circlize_0.4.8</span><span class="w">         </span><span class="n">Hmisc_4.2</span><span class="m">-0</span><span class="w">            </span><span class="n">plyr_1.8.4</span><span class="w">             </span><span class="n">lazyeval_0.2.2</span><span class="w">         </span><span class="n">GSEABase_1.46.0</span><span class="w">        </span><span class="n">splines_3.6.1</span><span class="w">          </span><span class="n">digest_0.6.21</span><span class="w">         
  </span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="n">htmltools_0.3.6</span><span class="w">        </span><span class="n">magrittr_1.5</span><span class="w">           </span><span class="n">checkmate_1.9.4</span><span class="w">        </span><span class="n">memoise_1.1.0</span><span class="w">          </span><span class="n">cluster_2.1.0</span><span class="w">          </span><span class="n">readr_1.3.1</span><span class="w">            </span><span class="n">annotate_1.62.0</span><span class="w">        </span><span class="n">askpass_1.1</span><span class="w">           
 </span><span class="p">[</span><span class="m">17</span><span class="p">]</span><span class="w"> </span><span class="n">prettyunits_1.0.2</span><span class="w">      </span><span class="n">colorspace_1.4</span><span class="m">-1</span><span class="w">       </span><span class="n">blob_1.2.0</span><span class="w">             </span><span class="n">rvest_0.3.4</span><span class="w">            </span><span class="n">xfun_0.10</span><span class="w">              </span><span class="n">jsonlite_1.6</span><span class="w">           </span><span class="n">crayon_1.3.4</span><span class="w">           </span><span class="n">RCurl_1.95</span><span class="m">-4.12</span><span class="w">       
 </span><span class="p">[</span><span class="m">25</span><span class="p">]</span><span class="w"> </span><span class="n">graph_1.62.0</span><span class="w">           </span><span class="n">genefilter_1.66.0</span><span class="w">      </span><span class="n">zeallot_0.1.0</span><span class="w">          </span><span class="n">survival_2.44</span><span class="m">-1.1</span><span class="w">      </span><span class="n">glue_1.3.1</span><span class="w">             </span><span class="n">gtable_0.3.0</span><span class="w">           </span><span class="n">zlibbioc_1.30.0</span><span class="w">        </span><span class="n">XVector_0.24.0</span><span class="w">        
 </span><span class="p">[</span><span class="m">33</span><span class="p">]</span><span class="w"> </span><span class="n">webshot_0.5.1</span><span class="w">          </span><span class="n">GetoptLong_0.1.7</span><span class="w">       </span><span class="n">Rhdf5lib_1.6.1</span><span class="w">         </span><span class="n">shape_1.4.4</span><span class="w">            </span><span class="n">abind_1.4</span><span class="m">-5</span><span class="w">            </span><span class="n">DBI_1.0.0</span><span class="w">              </span><span class="n">Rcpp_1.0.2</span><span class="w">             </span><span class="n">viridisLite_0.3.0</span><span class="w">     
 </span><span class="p">[</span><span class="m">41</span><span class="p">]</span><span class="w"> </span><span class="n">xtable_1.8</span><span class="m">-4</span><span class="w">           </span><span class="n">progress_1.2.2</span><span class="w">         </span><span class="n">htmlTable_1.13.2</span><span class="w">       </span><span class="n">clue_0.3</span><span class="m">-57</span><span class="w">            </span><span class="n">reticulate_1.13</span><span class="w">        </span><span class="n">foreign_0.8</span><span class="m">-72</span><span class="w">         </span><span class="n">bit_1.1</span><span class="m">-14</span><span class="w">             </span><span class="n">Formula_1.2</span><span class="m">-3</span><span class="w">         
 </span><span class="p">[</span><span class="m">49</span><span class="p">]</span><span class="w"> </span><span class="n">htmlwidgets_1.3</span><span class="w">        </span><span class="n">httr_1.4.1</span><span class="w">             </span><span class="n">acepack_1.4.1</span><span class="w">          </span><span class="n">pkgconfig_2.0.3</span><span class="w">        </span><span class="n">XML_3.98</span><span class="m">-1.20</span><span class="w">          </span><span class="n">nnet_7.3</span><span class="m">-12</span><span class="w">            </span><span class="n">locfit_1.5</span><span class="m">-9.1</span><span class="w">         </span><span class="n">tidyselect_0.2.5</span><span class="w">      
 </span><span class="p">[</span><span class="m">57</span><span class="p">]</span><span class="w"> </span><span class="n">rlang_0.4.0</span><span class="w">            </span><span class="n">later_0.8.0</span><span class="w">            </span><span class="n">AnnotationDbi_1.46.1</span><span class="w">   </span><span class="n">munsell_0.5.0</span><span class="w">          </span><span class="n">tools_3.6.1</span><span class="w">            </span><span class="n">RSQLite_2.1.2</span><span class="w">          </span><span class="n">evaluate_0.14</span><span class="w">          </span><span class="n">stringr_1.4.0</span><span class="w">         
 </span><span class="p">[</span><span class="m">65</span><span class="p">]</span><span class="w"> </span><span class="n">bit64_0.9</span><span class="m">-7</span><span class="w">            </span><span class="n">zip_2.0.4</span><span class="w">              </span><span class="n">purrr_0.3.2</span><span class="w">            </span><span class="n">nlme_3.1</span><span class="m">-141</span><span class="w">           </span><span class="n">mime_0.7</span><span class="w">               </span><span class="n">xml2_1.2.2</span><span class="w">             </span><span class="n">compiler_3.6.1</span><span class="w">         </span><span class="n">shinythemes_1.1.2</span><span class="w">     
 </span><span class="p">[</span><span class="m">73</span><span class="p">]</span><span class="w"> </span><span class="n">rstudioapi_0.10</span><span class="w">        </span><span class="n">png_0.1</span><span class="m">-7</span><span class="w">              </span><span class="n">tibble_2.1.3</span><span class="w">           </span><span class="n">geneplotter_1.62.0</span><span class="w">     </span><span class="n">stringi_1.4.3</span><span class="w">          </span><span class="n">cubature_2.0.3</span><span class="w">         </span><span class="n">lattice_0.20</span><span class="m">-38</span><span class="w">        </span><span class="n">nloptr_1.2.1</span><span class="w">          
 </span><span class="p">[</span><span class="m">81</span><span class="p">]</span><span class="w"> </span><span class="n">tensorA_0.36.1</span><span class="w">         </span><span class="n">vctrs_0.2.0</span><span class="w">            </span><span class="n">pillar_1.4.2</span><span class="w">           </span><span class="n">lifecycle_0.1.0</span><span class="w">        </span><span class="n">GlobalOptions_0.1.1</span><span class="w">    </span><span class="n">ucminf_1.1</span><span class="m">-4</span><span class="w">           </span><span class="n">data.table_1.12.2</span><span class="w">      </span><span class="n">bitops_1.0</span><span class="m">-6</span><span class="w">          
 </span><span class="p">[</span><span class="m">89</span><span class="p">]</span><span class="w"> </span><span class="n">corpcor_1.6.9</span><span class="w">          </span><span class="n">httpuv_1.5.2</span><span class="w">           </span><span class="n">R6_2.4.0</span><span class="w">               </span><span class="n">latticeExtra_0.6</span><span class="m">-28</span><span class="w">    </span><span class="n">promises_1.0.1</span><span class="w">         </span><span class="n">gridExtra_2.3</span><span class="w">          </span><span class="n">boot_1.3</span><span class="m">-23</span><span class="w">            </span><span class="n">assertthat_0.2.1</span><span class="w">      
 </span><span class="p">[</span><span class="m">97</span><span class="p">]</span><span class="w"> </span><span class="n">rhdf5_2.28.0</span><span class="w">           </span><span class="n">openssl_1.4.1</span><span class="w">          </span><span class="n">rjson_0.2.20</span><span class="w">           </span><span class="n">withr_2.1.2</span><span class="w">            </span><span class="n">GenomeInfoDbData_1.2.1</span><span class="w"> </span><span class="n">hms_0.5.1</span><span class="w">              </span><span class="n">rpart_4.1</span><span class="m">-15</span><span class="w">           </span><span class="n">tidyr_1.0.0</span><span class="w">           
</span><span class="p">[</span><span class="m">105</span><span class="p">]</span><span class="w"> </span><span class="n">minqa_1.2.4</span><span class="w">            </span><span class="n">misc3d_0.8</span><span class="m">-4</span><span class="w">           </span><span class="n">numDeriv_2016.8</span><span class="m">-1.1</span><span class="w">    </span><span class="n">shiny_1.3.2</span><span class="w">            </span><span class="n">base64enc_0.1</span><span class="m">-3</span><span class="w">       
</span></code></pre></div></div>
:ET